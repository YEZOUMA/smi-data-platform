# =============================================================================
# CONFIGURATION ENVIRONNEMENT - SMI DATA PLATFORM
# =============================================================================
# Copier ce fichier en .env et remplir avec vos valeurs

# =============================================================================
# AIRFLOW CONFIGURATION
# =============================================================================
AIRFLOW_UID=50000
AIRFLOW__CORE__EXECUTOR=LocalExecutor
AIRFLOW__CORE__LOAD_EXAMPLES=False
AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION=True
AIRFLOW__API__AUTH_BACKENDS=airflow.api.auth.backend.basic_auth
AIRFLOW__WEBSERVER__SECRET_KEY=votre-secret-key-airflow-a-changer

# Airflow Database (Metadata)
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@postgres-airflow/airflow

# =============================================================================
# POSTGRESQL DATA WAREHOUSE
# =============================================================================
POSTGRES_HOST=postgres-dwh
POSTGRES_PORT=5432
POSTGRES_DB=smi_dwh
POSTGRES_USER=smi_user
POSTGRES_PASSWORD=smi_password
POSTGRES_SCHEMA_BRONZE=bronze
POSTGRES_SCHEMA_SILVER=silver
POSTGRES_SCHEMA_GOLD=gold

# Connection String
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# =============================================================================
# MINIO / S3 STORAGE
# =============================================================================
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET_BRONZE=smi-bronze
MINIO_BUCKET_SILVER=smi-silver
MINIO_BUCKET_GOLD=smi-gold
MINIO_BUCKET_BACKUPS=smi-backups
MINIO_USE_SSL=False

# AWS S3 (si utilisé au lieu de MinIO)
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1
# S3_BUCKET=smi-data

# =============================================================================
# REDIS
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# =============================================================================
# APACHE SUPERSET
# =============================================================================
SUPERSET_SECRET_KEY=votre-secret-key-superset-a-changer
SUPERSET_ADMIN_USER=admin
SUPERSET_ADMIN_PASSWORD=admin
SUPERSET_ADMIN_EMAIL=admin@smi-platform.bf

# Superset Database
SUPERSET_DATABASE_DIALECT=postgresql
SUPERSET_DATABASE_USER=superset
SUPERSET_DATABASE_PASSWORD=superset
SUPERSET_DATABASE_HOST=postgres-superset
SUPERSET_DATABASE_PORT=5432
SUPERSET_DATABASE_DB=superset

# =============================================================================
# MONITORING - PROMETHEUS & GRAFANA
# =============================================================================
PROMETHEUS_RETENTION_TIME=15d
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_PORT=3000

# =============================================================================
# ALERTMANAGER
# =============================================================================
ALERTMANAGER_SMTP_HOST=smtp.gmail.com
ALERTMANAGER_SMTP_PORT=587
ALERTMANAGER_SMTP_USER=alerts@smi-platform.bf
ALERTMANAGER_SMTP_PASSWORD=votre-mot-de-passe
ALERTMANAGER_EMAIL_TO=admin@smi-platform.bf

# Slack (optionnel)
ALERTMANAGER_SLACK_WEBHOOK_URL=
ALERTMANAGER_SLACK_CHANNEL=#smi-alerts

# =============================================================================
# SENTRY (ERROR TRACKING)
# =============================================================================
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# =============================================================================
# DBT CONFIGURATION
# =============================================================================
DBT_PROFILES_DIR=/opt/airflow/dbt
DBT_PROJECT_DIR=/opt/airflow/dbt
DBT_TARGET=prod

# =============================================================================
# DATA QUALITY - GREAT EXPECTATIONS
# =============================================================================
GE_DATA_CONTEXT_ROOT_DIR=/opt/airflow/great_expectations
GE_ENABLE_VALIDATION=True

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
# Environnement (dev, staging, production)
ENVIRONMENT=production

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_DIR=/opt/airflow/logs

# Timezone
TZ=Africa/Ouagadougou

# =============================================================================
# PIPELINE CONFIGURATION
# =============================================================================
# Source de données
SOURCE_DATA_PATH=/opt/airflow/data/source
SOURCE_FILE_NAME=Donnees_POC2024_2025_10122025.xls

# Chemins de stockage
DATA_PATH_BRONZE=/opt/airflow/data/bronze
DATA_PATH_SILVER=/opt/airflow/data/silver
DATA_PATH_GOLD=/opt/airflow/data/gold

# Configuration du pipeline
PIPELINE_BATCH_SIZE=5000
PIPELINE_PARALLEL_WORKERS=4
PIPELINE_RETRY_ATTEMPTS=3
PIPELINE_RETRY_DELAY=300

# Notifications
ENABLE_EMAIL_NOTIFICATIONS=True
ENABLE_SLACK_NOTIFICATIONS=False
NOTIFICATION_EMAIL_LIST=admin@smi-platform.bf,yezou@sandtechnologies.bf

# =============================================================================
# PERFORMANCE & RESOURCES
# =============================================================================
# PostgreSQL
POSTGRES_MAX_CONNECTIONS=100
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_WORK_MEM=32MB

# Airflow
AIRFLOW_PARALLELISM=32
AIRFLOW_MAX_ACTIVE_TASKS=16
AIRFLOW_MAX_ACTIVE_RUNS_PER_DAG=3

# =============================================================================
# SÉCURITÉ
# =============================================================================
# Authentification
AUTH_BACKEND=airflow.api.auth.backend.basic_auth
ENABLE_RBAC=True

# Chiffrement
ENCRYPT_SENSITIVE_DATA=True
ENCRYPTION_KEY=votre-cle-chiffrement-32-caracteres

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================
BACKUP_ENABLED=True
BACKUP_SCHEDULE="0 2 * * *"  # 2h AM tous les jours
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=/opt/airflow/backups

# =============================================================================
# DÉVELOPPEMENT (DEV ONLY)
# =============================================================================
DEBUG=False
RELOAD_ON_CHANGE=False
PROFILING_ENABLED=False

# =============================================================================
# API KEYS (SI NÉCESSAIRE)
# =============================================================================
# API Externe (si besoin)
EXTERNAL_API_KEY=
EXTERNAL_API_URL=

# =============================================================================
# NOTES
# =============================================================================
# - Ne jamais commiter le fichier .env dans Git
# - Changer tous les mots de passe et secrets en production
# - Utiliser des gestionnaires de secrets (AWS Secrets Manager, Vault, etc.)
# - Documenter toute modification des variables
